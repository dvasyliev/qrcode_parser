{"version":3,"sources":["webpack:///src/App.vue","webpack:///./src/App.vue?5d03","webpack:///./src/App.vue","webpack:///./src/main.js","webpack:///./src/config/qrcode.json","webpack:///./src/utils/qrcode.js"],"names":["App","name","data","qrcode","computed","isCorrectChecksum","Object","this","qrcodeTransformed","qrcodeModel","html_stringify_default","model","selectortype_template_index_0_src_App","render","_vm","_h","$createElement","_c","_self","attrs","id","staticClass","_v","type","placeholder","resize","rows","value","callback","$$v","expression","length","domProps","innerHTML","_s","_e","title","show-icon","closable","staticRenderFns","src_App","__webpack_require__","normalizeComponent","ssrContext","vue_esm","use","element_ui_common_default","a","config","productionTip","el","components","template","module","exports","default","11","12","min","max","children","00","01","_isTwoDigits","match","crc","lastBlob","slice","_getCRC","string","hex","__WEBPACK_IMPORTED_MODULE_2_crc_full__","compute","Buffer","from","toString","toUpperCase","console","error","_calcCRC","parseBlob","parseInt","_isValue","getQrCodeModel","transform","definitions","fields","forEach","definition","field","__WEBPACK_IMPORTED_MODULE_1_lodash___default","find","has","isArray","__WEBPACK_IMPORTED_MODULE_3__config_qrcode___default","parse","deep","deepCounter","arguments","undefined","blob","blobChild","remainderChild","blobChildren","concat","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray___default","map","parent_id","remainder"],"mappings":"2KA0CAA,GACAC,KAAA,MAEAC,KAHA,WAIA,OACAC,OAAA,KAIAC,UACAC,kBADA,WAEA,OAAAC,OAAAH,EAAA,EAAAG,CAAAC,KAAAJ,SAGAK,kBALA,WAMA,OAAAD,KAAAF,kBAAAC,OAAAH,EAAA,EAAAG,CAAAC,KAAAJ,QAAA,MAGAM,YATA,WAUA,OAAAF,KAAAF,kBAAAK,KAAAC,MAAAJ,KAAAC,oBAAA,MC1DAI,GADiBC,OAFjB,WAA0B,IAAAC,EAAAP,KAAaQ,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,OAAOC,GAAA,SAAYH,EAAA,OAAYI,YAAA,SAAmBJ,EAAA,OAAYI,YAAA,gBAA0BJ,EAAA,OAAYI,YAAA,kBAA4BJ,EAAA,KAAAH,EAAAQ,GAAA,qBAAAR,EAAAQ,GAAA,KAAAL,EAAA,YAAiEE,OAAOI,KAAA,WAAAC,YAAA,4BAAAC,OAAA,OAAAC,KAAA,GAAqFf,OAAQgB,MAAAb,EAAA,OAAAc,SAAA,SAAAC,GAA4Cf,EAAAX,OAAA0B,GAAeC,WAAA,YAAsBhB,EAAAQ,GAAA,KAAAL,EAAA,KAAAH,EAAAQ,GAAA,oBAAAR,EAAAQ,GAAA,KAAAR,EAAAX,OAAA4B,QAAAjB,EAAAT,kBAAAY,EAAA,OAAoHI,YAAA,aAAAW,UAAmCC,UAAAnB,EAAAoB,GAAApB,EAAAL,gBAAqCK,EAAAqB,KAAArB,EAAAQ,GAAA,KAAAR,EAAAX,OAAA4B,OAAwIjB,EAAAT,kBAA8IS,EAAAqB,KAA9IlB,EAAA,YAA0CE,OAAOiB,MAAA,qCAAAb,KAAA,QAAAc,YAAA,GAAAC,UAAA,KAAzLrB,EAAA,YAA2DE,OAAOiB,MAAA,eAAAb,KAAA,OAAAc,YAAA,GAAAC,UAAA,MAAoN,UAEj6BC,oBCCjB,IAuBAC,EAvBAC,EAAA,OAcAC,CACA1C,EACAY,GATA,EAVA,SAAA+B,GACAF,EAAA,SAaA,KAEA,MAUA,uCClBAG,EAAA,QAAIC,IAAIC,EAAAC,GACRH,EAAA,QAAII,OAAOC,eAAgB,EAG3B,IAAIL,EAAA,SACFM,GAAI,OACJC,YAAcnD,IAAAwC,GACdY,SAAU,+BCfZC,EAAAC,UAAmBlC,GAAA,KAAAW,OAAA,KAAA9B,KAAA,6BAA4DmB,GAAA,KAAAW,OAAA,KAAAwB,SAAmCC,GAAA,SAAAC,GAAA,WAA6BxD,KAAA,+BAAuCmB,IAAMsC,IAAA,KAAAC,IAAA,MAAsB5B,QAAW2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,iCAAyCmB,GAAA,KAAAW,OAAA,KAAA9B,KAAA,2BAA0DmB,GAAA,KAAAW,OAAA,KAAA9B,KAAA,yBAAwDmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,uBAA+BmB,GAAA,KAAAW,OAAA,KAAA9B,KAAA,iCAAgEmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,mCAA2CmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,wCAAgDmB,GAAA,KAAAW,OAAA,KAAA9B,KAAA,iBAAgDmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,kBAA0BmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,kBAA0BmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,gBAAwBmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,wBAAA2D,WAA6CxC,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,gBAAwBmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,kBAA0BmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,gBAAwBmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,mBAA2BmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,oBAA4BmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,mBAA2BmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,mBAA2BmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,2BAAmCmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,qCAA6CmB,IAAMsC,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,kBAA0BmB,IAAMsC,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,qBAA6BmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,uBAAA2D,WAA4CxC,GAAA,KAAAW,OAAA,KAAA9B,KAAA,wBAAuDmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,oBAA4BmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,4BAAA2D,WAAiDxC,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,+BAAuCmB,GAAA,KAAAW,OAAA,KAAAwB,SAAmCM,KAAA,MAAAC,KAAA,OAAsB7D,KAAA,eAAuBmB,GAAA,KAAAW,OAAA,KAAA9B,KAAA,eAA8CmB,GAAA,KAAAW,OAAA,KAAA9B,KAAA,gBAA+CmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,6BAAqCmB,GAAA,KAAAW,OAAA,KAAAwB,SAAmCM,KAAA,uBAAAC,KAAA,mBAAmD7D,KAAA,kBAA0BmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,yBAAA2D,WAA8CxC,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,+BAAuCmB,GAAA,KAAAW,OAAA,KAAA9B,KAAA,eAA8CmB,GAAA,KAAAW,QAAoB2B,IAAA,KAAAC,IAAA,MAAsB1D,KAAA,oBAA4BmB,GAAA,KAAAW,OAAA,KAAA9B,KAAA,yPCIzwF8D,EAAe,SAACpC,GACpB,OAAiC,OAA1BA,EAAMqC,MAAM,WA2Bf3D,EAAoB,SAACF,GACzB,IAAM8D,EArBQ,SAAC9D,GACf,IAAM+D,EAAW/D,EAAOgE,MAAMhE,EAAO4B,OAAS,EAAG5B,EAAO4B,QAClDX,EAAK8C,EAASC,MAAM,EAAG,GACvBpC,EAASmC,EAASC,MAAM,EAAG,GAC3BxC,EAAQuC,EAASC,MAAM,EAAG,GAEhC,MAAe,OAAP/C,GAA0B,OAAXW,GAAoC,IAAjBJ,EAAMI,OAAgBJ,EAAQ,KAe5DyC,CAAQjE,GAEpB,QAAO8D,GAAMA,IAdE,SAAC9D,GAChB,IAAMkE,EAASlE,EAAOgE,MAAM,GAAI,GAG1BG,EAFM,IAAIC,EAAA,IAAI,QAAS,GAAI,KAAQ,OACrBC,QAAQC,EAAOC,KAAKL,EAAQ,UAC5BM,SAAS,IAAIC,cAIjC,OAFAC,QAAQC,MAAM,wBAAyBR,GAEhCA,EAMcS,CAAS5E,IAG1B6E,EAAY,SAACX,GACjB,IAAMjD,EAAKiD,EAAOF,MAAM,EAAG,GACrBpC,EAASsC,EAAOF,MAAM,EAAG,GACzBxC,EAAQ0C,EAAOF,MAAM,EAAG,EAAIc,SAASlD,EAAQ,KAEnD,OAAKgC,EAAa3C,IAAQ2C,EAAahC,IAnCxB,SAACJ,EAAOI,GACvB,OAAOJ,EAAMI,QAAUJ,EAAMI,SAAWkD,SAASlD,EAAQ,IAkCNmD,CAASvD,EAAOI,IAI1DX,KAAIW,SAAQJ,SAHZ,MAsDLwD,EAAiB,SAAChF,GACtB,OAxBgB,SAAZiF,EAAaC,EAAaC,GAC9B,IAAM3E,KAmBN,OAjBA0E,EAAYE,QAAQ,SAAAC,GAClB,IAAMC,EAAQC,EAAA3C,EAAE4C,KAAKL,GAAUlE,GAAIoE,EAAWpE,KAE9C,IAAKsE,EAAA3C,EAAE6C,IAAIJ,EAAY,QAErB,OADAX,QAAQC,MAAR,oDAAkEU,EAAWpE,KACtE,EAGT,GAAIsE,EAAA3C,EAAE6C,IAAIJ,EAAY,YAAa,CACjC,IAAM7D,EAAQ+D,EAAA3C,EAAE6C,IAAIH,EAAO,UAAYC,EAAA3C,EAAE8C,QAAQJ,EAAM9D,OAAS8D,EAAM9D,SAEtEhB,EAAM6E,EAAWvF,MAAQmF,EAAUI,EAAW5B,SAAUjC,QAExDhB,EAAM6E,EAAWvF,MAAQyF,EAAA3C,EAAE6C,IAAIH,EAAO,SAAWA,EAAM9D,MAAQ,OAI5DhB,EAIAyE,CAAUU,EAAA/C,EAjDL,SAARgD,EAAS1B,EAAQ2B,GAA0B,IAApBC,EAAoBC,UAAAnE,OAAA,QAAAoE,IAAAD,UAAA,GAAAA,UAAA,GAAN,EACrCE,EAAOpB,EAAUX,GAErB,IAAK+B,EACH,SAGF,IAAMC,EAAYrB,EAAUoB,EAAKzE,OAEjC,GAAI0E,GAAaJ,EAAcD,EAAM,CACnC,IAAMM,EAAiBF,EAAKzE,MAAMwC,MAAM,EAAIc,SAASoB,EAAUtE,OAAQ,KACjEwE,GAAgBF,GAADG,OAAAC,IAAeV,EAAMO,EAAgBN,IAAQC,KAAcS,IAAI,SAAAxD,GAGlF,OAFAA,EAAGyD,UAAYP,EAAKhF,GAEb8B,IAGTkD,EAAKzE,MAAQ4E,EAGf,IAAMK,EAAYvC,EAAOF,MAAM,EAAIc,SAASmB,EAAKrE,OAAQ,KAEzD,OAAQqE,GAARI,OAAAC,IAAiBV,EAAMa,EAAWZ,EAAMC,KA2BVF,CAAM5F,EAAQ","file":"static/js/app.7cda2fcee299f83ea2e9.js","sourcesContent":["<template>\n  <div id=\"app\">\n    <div class=\"page\">\n      <div class=\"page__inner\">\n        <div class=\"page__content\">\n          <p>QR-code String:</p>\n          <el-input\n            v-model=\"qrcode\"\n            type=\"textarea\"\n            placeholder=\"Type your QR-code here...\"\n            resize=\"none\"\n            :rows=\"3\"/>\n\n          <p>QR-code Model:</p>\n          <div\n            v-if=\"qrcode.length && isCorrectChecksum\"\n            v-html=\"qrcodeModel\"\n            class=\"page__json\"/>\n\n          <el-alert\n            v-if=\"!qrcode.length\"\n            title=\"Enter qrcode\"\n            type=\"info\"\n            show-icon\n            :closable=\"false\"/>\n\n          <el-alert\n            v-else-if=\"!isCorrectChecksum\"\n            title=\"Check sum not exist or not correct\"\n            type=\"error\"\n            show-icon\n            :closable=\"false\"/>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport htmlStringify from 'html-stringify'\nimport { isCorrectChecksum, getQrCodeModel } from '@/utils/qrcode'\n\nexport default {\n  name: 'App',\n\n  data() {\n    return {\n      qrcode: ''\n    }\n  },\n\n  computed: {\n    isCorrectChecksum() {\n      return isCorrectChecksum(this.qrcode)\n    },\n\n    qrcodeTransformed() {\n      return this.isCorrectChecksum ? getQrCodeModel(this.qrcode) : null\n    },\n\n    qrcodeModel() {\n      return this.isCorrectChecksum ? htmlStringify({ model: this.qrcodeTransformed }) : ''\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\nhtml,\nbody {\n  margin: 0;\n  padding: 0;\n}\n\n#app {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n}\n\n.page {\n  display: flex;\n  flex-direction: column;\n  min-height: 100vh;\n  box-sizing: border-box;\n  padding: 60px 0;\n  background-color: #F7F7F7;\n\n  &__inner {\n    display: flex;\n    flex-grow: 1;\n    width: 100%;\n    max-width: 900px;\n    margin: 0 auto;\n    padding: 20px;\n    background-color: #FFFFFF;\n    border: 1px solid #D2D6D9;\n    border-radius: 6px;\n  }\n\n  &__content {\n    width: 100%;\n    text-align: left;\n  }\n\n  &__json {\n    margin-top: 14px;\n    padding: 30px;\n    background: #F7F7F7;\n    border: 1px solid #D2D6D9;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{staticClass:\"page\"},[_c('div',{staticClass:\"page__inner\"},[_c('div',{staticClass:\"page__content\"},[_c('p',[_vm._v(\"QR-code String:\")]),_vm._v(\" \"),_c('el-input',{attrs:{\"type\":\"textarea\",\"placeholder\":\"Type your QR-code here...\",\"resize\":\"none\",\"rows\":3},model:{value:(_vm.qrcode),callback:function ($$v) {_vm.qrcode=$$v},expression:\"qrcode\"}}),_vm._v(\" \"),_c('p',[_vm._v(\"QR-code Model:\")]),_vm._v(\" \"),(_vm.qrcode.length && _vm.isCorrectChecksum)?_c('div',{staticClass:\"page__json\",domProps:{\"innerHTML\":_vm._s(_vm.qrcodeModel)}}):_vm._e(),_vm._v(\" \"),(!_vm.qrcode.length)?_c('el-alert',{attrs:{\"title\":\"Enter qrcode\",\"type\":\"info\",\"show-icon\":\"\",\"closable\":false}}):(!_vm.isCorrectChecksum)?_c('el-alert',{attrs:{\"title\":\"Check sum not exist or not correct\",\"type\":\"error\",\"show-icon\":\"\",\"closable\":false}}):_vm._e()],1)])])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-7ef219b9\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-7ef219b9\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-7ef219b9\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\n\nimport ElementUI from 'element-ui'\nimport 'element-ui/lib/theme-chalk/index.css'\n\nVue.use(ElementUI)\nVue.config.productionTip = false\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  components: { App },\n  template: '<App/>'\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","module.exports = [{\"id\":\"00\",\"length\":\"02\",\"name\":\"payload_format_indicator\"},{\"id\":\"01\",\"length\":\"02\",\"default\":{\"11\":\"Static\",\"12\":\"Dynamic\"},\"name\":\"point_of_initiation_method\"},{\"id\":{\"min\":\"02\",\"max\":\"51\"},\"length\":{\"min\":\"00\",\"max\":\"99\"},\"name\":\"merchant_account_information\"},{\"id\":\"52\",\"length\":\"04\",\"name\":\"merchant_category_code\"},{\"id\":\"53\",\"length\":\"03\",\"name\":\"transaction_currency\"},{\"id\":\"54\",\"length\":{\"min\":\"01\",\"max\":\"13\"},\"name\":\"transaction_amount\"},{\"id\":\"55\",\"length\":\"02\",\"name\":\"tip_or_convenience_indicator\"},{\"id\":\"56\",\"length\":{\"min\":\"01\",\"max\":\"13\"},\"name\":\"value_of_convenience_fee_fixed\"},{\"id\":\"57\",\"length\":{\"min\":\"01\",\"max\":\"05\"},\"name\":\"value_of_convenience_fee_percentage\"},{\"id\":\"58\",\"length\":\"02\",\"name\":\"country_code\"},{\"id\":\"59\",\"length\":{\"min\":\"00\",\"max\":\"75\"},\"name\":\"merchant_name\"},{\"id\":\"60\",\"length\":{\"min\":\"01\",\"max\":\"15\"},\"name\":\"merchant_city\"},{\"id\":\"61\",\"length\":{\"min\":\"01\",\"max\":\"10\"},\"name\":\"postal_code\"},{\"id\":\"62\",\"length\":{\"min\":\"01\",\"max\":\"99\"},\"name\":\"additional_data_field\",\"children\":[{\"id\":\"01\",\"length\":{\"min\":\"00\",\"max\":\"25\"},\"name\":\"bill_number\"},{\"id\":\"02\",\"length\":{\"min\":\"00\",\"max\":\"25\"},\"name\":\"mobile_number\"},{\"id\":\"03\",\"length\":{\"min\":\"00\",\"max\":\"25\"},\"name\":\"store_label\"},{\"id\":\"04\",\"length\":{\"min\":\"00\",\"max\":\"25\"},\"name\":\"loyalty_number\"},{\"id\":\"05\",\"length\":{\"min\":\"00\",\"max\":\"25\"},\"name\":\"reference_label\"},{\"id\":\"06\",\"length\":{\"min\":\"00\",\"max\":\"25\"},\"name\":\"customer_label\"},{\"id\":\"07\",\"length\":{\"min\":\"00\",\"max\":\"25\"},\"name\":\"terminal_label\"},{\"id\":\"08\",\"length\":{\"min\":\"00\",\"max\":\"25\"},\"name\":\"purpose_of_transaction\"},{\"id\":\"09\",\"length\":{\"min\":\"00\",\"max\":\"03\"},\"name\":\"additional_consumer_data_request\"},{\"id\":{\"min\":\"10\",\"max\":\"49\"},\"name\":\"rfu_for_emvco\"},{\"id\":{\"min\":\"50\",\"max\":\"99\"},\"name\":\"payment_system\"}]},{\"id\":\"64\",\"length\":{\"min\":\"00\",\"max\":\"99\"},\"name\":\"merchant_information\",\"children\":[{\"id\":\"00\",\"length\":\"02\",\"name\":\"language_preference\"},{\"id\":\"01\",\"length\":{\"min\":\"00\",\"max\":\"75\"},\"name\":\"merchant_name\"}]},{\"id\":\"80\",\"length\":{\"min\":\"00\",\"max\":\"99\"},\"name\":\"qr_parameters_information\",\"children\":[{\"id\":\"00\",\"length\":{\"min\":\"01\",\"max\":\"32\"},\"name\":\"globally_unique_identifier\"},{\"id\":\"01\",\"length\":\"02\",\"default\":{\"00\":\"P2P\",\"01\":\"P2M\"},\"name\":\"p2p_vs_p2m\"},{\"id\":\"02\",\"length\":\"08\",\"name\":\"channel_id\"},{\"id\":\"03\",\"length\":\"20\",\"name\":\"merchant_id\"},{\"id\":\"04\",\"length\":{\"min\":\"00\",\"max\":\"12\"},\"name\":\"request_reference_number\"},{\"id\":\"05\",\"length\":\"02\",\"default\":{\"00\":\"Amount is Changeable\",\"01\":\"Amount is Fixed\"},\"name\":\"amount_type\"}]},{\"id\":\"81\",\"length\":{\"min\":\"00\",\"max\":\"99\"},\"name\":\"qr_parameters_lifetime\",\"children\":[{\"id\":\"00\",\"length\":{\"min\":\"01\",\"max\":\"32\"},\"name\":\"globally_unique_identifier\"},{\"id\":\"01\",\"length\":\"17\",\"name\":\"start_date\"},{\"id\":\"02\",\"length\":{\"min\":\"01\",\"max\":\"10\"},\"name\":\"code_lifetime\"}]},{\"id\":\"63\",\"length\":\"04\",\"name\":\"cyclic_redundancy_check\"}]\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/config/qrcode.json\n// module id = QlUo\n// module chunks = 1","import _ from 'lodash'\nimport { CRC } from 'crc-full'\nimport definitions from '@/config/qrcode'\n\nconst _isTwoDigits = (value) => {\n  return value.match(/^\\d{2}/) !== null\n}\n\nconst _isValue = (value, length) => {\n  return value.length && value.length === parseInt(length, 10)\n}\n\nconst _getCRC = (qrcode) => {\n  const lastBlob = qrcode.slice(qrcode.length - 8, qrcode.length)\n  const id = lastBlob.slice(0, 2)\n  const length = lastBlob.slice(2, 4)\n  const value = lastBlob.slice(4, 8)\n\n  return (id === '63' && length === '04' && value.length === 4) ? value : null\n}\n\nconst _calcCRC = (qrcode) => {\n  const string = qrcode.slice(0, -8)\n  const crc = new CRC('CRC16', 16, 0x1027, 0xFFFF)\n  const demical = crc.compute(Buffer.from(string, 'ascii'))\n  const hex = demical.toString(16).toUpperCase()\n\n  console.error('CRC should be equal: ', hex)\n\n  return hex\n}\n\nconst isCorrectChecksum = (qrcode) => {\n  const crc = _getCRC(qrcode)\n\n  return crc ? crc === _calcCRC(qrcode) : false\n}\n\nconst parseBlob = (string) => {\n  const id = string.slice(0, 2)\n  const length = string.slice(2, 4)\n  const value = string.slice(4, 4 + parseInt(length, 10))\n\n  if (!_isTwoDigits(id) || !_isTwoDigits(length) || !_isValue(value, length)) {\n    return null\n  }\n\n  return { id, length, value }\n}\n\nconst parse = (string, deep, deepCounter = 0) => {\n  let blob = parseBlob(string)\n\n  if (!blob) {\n    return []\n  }\n\n  const blobChild = parseBlob(blob.value)\n\n  if (blobChild && deepCounter < deep) {\n    const remainderChild = blob.value.slice(4 + parseInt(blobChild.length, 10))\n    const blobChildren = [blobChild, ...parse(remainderChild, deep, ++deepCounter)].map(el => {\n      el.parent_id = blob.id\n\n      return el\n    })\n\n    blob.value = blobChildren\n  }\n\n  const remainder = string.slice(4 + parseInt(blob.length, 10))\n\n  return [blob, ...parse(remainder, deep, deepCounter)]\n}\n\nconst transform = (definitions, fields) => {\n  const model = {}\n\n  definitions.forEach(definition => {\n    const field = _.find(fields, { id: definition.id })\n\n    if (!_.has(definition, 'name')) {\n      console.error(`Missed \"name\" attribute for definition with ID = ${definition.id}`)\n      return false\n    }\n\n    if (_.has(definition, 'children')) {\n      const value = _.has(field, 'value') && _.isArray(field.value) ? field.value : []\n\n      model[definition.name] = transform(definition.children, value)\n    } else {\n      model[definition.name] = _.has(field, 'value') ? field.value : null\n    }\n  })\n\n  return model\n}\n\nconst getQrCodeModel = (qrcode) => {\n  return transform(definitions, parse(qrcode, 2))\n}\n\nexport {\n  isCorrectChecksum,\n  parseBlob,\n  parse,\n  transform,\n  getQrCodeModel\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/qrcode.js"],"sourceRoot":""}